#===================================================================================
# DRONE SWARM SIMULATION - FANET Research Configuration
#===================================================================================
# Author: Rodrigo Paczkovski
# Institution: University of Santa Catarina (UFSC)
# Program: Master's in Computer Science
# Date: October 2025
# Repository: github.com/ropacz/drone-swarm
#
# Description:
#   Simulation parameters for UAV swarm coordination research using OMNeT++/INET.
#   Focus: Inter-drone communication, mobility patterns, and network performance
#   for Search and Rescue (SAR) operations in disaster scenarios.
#
# Simulation Framework:
#   - OMNeT++ 6.2.0: Discrete event simulation
#   - INET 4.5.4: Internet protocol suite and wireless modeling
#
# Key Technologies:
#   - Network: Flying Ad-Hoc Network (FANET)
#   - Routing: Proactive mesh routing
#   - PHY: IEEE 802.11a @ 5.8 GHz
#   - Mobility: 3D Gauss-Markov model
#   - Application: UDP multicast telemetry
#
# References:
#   [1] Bekmezci et al. (2013) "Flying Ad-Hoc Networks (FANETs): A survey"
#   [2] Yanmaz et al. (2018) "Drone networks: Communications, coordination, and sensing"
#   [3] Hayat et al. (2016) "Survey on UAV networks for disaster relief"
#   [4] Erdelj et al. (2017) "Help from the sky: Leveraging UAVs for disaster management"
#   [5] RFC 3626: Optimized Link State Routing Protocol (OLSR)
#===================================================================================

[General]
network = drone.swarm.DroneSwarmNetwork

# Simulation control
sim-time-limit = 300s                   # 5 minutes (steady-state analysis)
seed-set = ${repetition}                # Reproducible randomness
repeat = 3                              # Statistical significance (min 3, recommend 10-30)
cmdenv-express-mode = true              # Fast execution
result-dir = results                    # Output directory

#===================================================================================
# NETWORK TOPOLOGY
#===================================================================================
# Swarm size: 10 drones + 1 GCS (typical for research simulations)
# Ref: [1] Brust et al. (2017) "Target tracking optimization of UAV swarms"
#===================================================================================
*.numDrones = 10                        # 10 UAVs (range: 5-20 typical)
*.numGCS = 1                            # Single ground control station

#===================================================================================
# MOBILITY MODEL - 3D Gauss-Markov
#===================================================================================
# Characteristics:
#   - Smooth continuous movement (realistic for UAVs)
#   - Memory parameter (alpha) controls temporal correlation
#   - Suitable for coordinated swarm behavior
#
# Ref: [1] Camp et al. (2002) "A survey of mobility models for ad hoc network research"
# Ref: [2] Sanchez-Garcia et al. (2018) "Self-organizing UAV swarm coordination"
#===================================================================================

*.drone[*].mobility.typename = "GaussMarkovMobility"

#-----------------------------------------------------------------------------------
# Operational airspace (5km × 5km SAR area)
#-----------------------------------------------------------------------------------
# Ref: [3] Hayat et al. (2016) "Survey on UAV networks for disaster relief"
# Ref: [4] Erdelj et al. (2017) "Help from the sky: Leveraging UAVs for disaster management"
# Typical SAR area: 5-10 km²
*.drone[*].mobility.constraintAreaMinX = 0m
*.drone[*].mobility.constraintAreaMaxX = 5000m
*.drone[*].mobility.constraintAreaMinY = 0m
*.drone[*].mobility.constraintAreaMaxY = 5000m
*.drone[*].mobility.constraintAreaMinZ = 50m
*.drone[*].mobility.constraintAreaMaxZ = 120m
*.drone[*].mobility.margin = 200m

#-----------------------------------------------------------------------------------
# Speed parameters
#-----------------------------------------------------------------------------------
# Cruise speed: 15 m/s (54 km/h) - energy-efficient for commercial drones
# Ref: DJI Mavic 3: 15-21 m/s, Auterion Skynode: 15-20 m/s
*.drone[*].mobility.speed = 15mps
*.drone[*].mobility.speedStdDev = 0mps
*.drone[*].mobility.angle = uniform(0deg, 360deg)
*.drone[*].mobility.angleStdDev = 30deg

#-----------------------------------------------------------------------------------
# Temporal correlation
#-----------------------------------------------------------------------------------
# Alpha = 0.8: High correlation (smooth coordinated movement)
# Range: [0,1] where 0=random walk, 1=linear motion
*.drone[*].mobility.alpha = 0.8
*.drone[*].mobility.updateInterval = 0.5s

#-----------------------------------------------------------------------------------
# Initial positions
#-----------------------------------------------------------------------------------
*.drone[*].mobility.initialX = uniform(500m, 4500m)
*.drone[*].mobility.initialY = uniform(500m, 4500m)
*.drone[*].mobility.initialZ = uniform(60m, 100m)

#===================================================================================
# PHYSICAL LAYER - IEEE 802.11a @ 5.8 GHz
#===================================================================================
# Technology: IEEE 802.11a in ad-hoc mode
# Frequency: 5.8 GHz ISM band (5.725-5.850 GHz)
# Advantages over 2.4 GHz: less congestion, higher data rates
#
# Ref: [2] Yanmaz et al. (2014) "Experimental performance of aerial 802.11 networks"
# Ref: IEEE 802.11-2016 standard
#===================================================================================

*.drone[*].numWlanInterfaces = 1
*.drone[*].wlan[0].typename = "Ieee80211Interface"
*.drone[*].wlan[0].mgmt.typename = "Ieee80211MgmtAdhoc"
*.drone[*].wlan[0].radio.typename = "Ieee80211ScalarRadio"

#-----------------------------------------------------------------------------------
# Radio frequency
#-----------------------------------------------------------------------------------
*.drone[*].wlan[0].radio.bandName = "5 GHz"
*.drone[*].wlan[0].radio.channel = 0
*.drone[*].wlan[0].radio.carrierFrequency = 5.8GHz
*.drone[*].wlan[0].radio.bandwidth = 20MHz

#-----------------------------------------------------------------------------------
# Transmitter (Drones)
#-----------------------------------------------------------------------------------
# Power: 5 mW (7 dBm) - typical for UAV mesh networks
# Expected range: ~300-500m @ 80m altitude
# Ref: Temel & Bekmezci (2017) "LODMAC: Location oriented directional MAC protocol"
*.drone[*].wlan[0].radio.transmitter.power = 5mW

#-----------------------------------------------------------------------------------
# Receiver (Drones)
#-----------------------------------------------------------------------------------
# Sensitivity: -75 dBm (balance between range and power consumption)
# Ref: [2] Yanmaz et al. (2018) "Wireless networking with drones"
*.drone[*].wlan[0].radio.receiver.sensitivity = -75dBm
*.drone[*].wlan[0].radio.receiver.energyDetection = -78dBm
*.drone[*].wlan[0].radio.receiver.snirThreshold = 6dB

#===================================================================================
# PROPAGATION MODEL - Two-Ray Ground Reflection
#===================================================================================
# More realistic than free-space for UAVs at 50-120m altitude
# Accounts for ground reflection effects
#
# Path loss: PL = 40log₁₀(d) - 20log₁₀(ht) - 20log₁₀(hr)
# where d=distance, ht=tx height, hr=rx height
#
# Ref: Rappaport (2002) "Wireless Communications: Principles and Practice"
# Ref: Al-Hourani et al. (2014) "Modeling air-to-ground path loss for low altitude platforms"
#===================================================================================

*.radioMedium.typename = "Ieee80211ScalarRadioMedium"
*.radioMedium.pathLossType = "TwoRayGroundReflection"
*.radioMedium.propagationType = "ConstantSpeedPropagation"

# Range limits (prevent unrealistic communication)
*.radioMedium.rangeFilter = "communicationRange"
*.radioMedium.mediumLimitCache.maxTransmissionRange = 800m
*.radioMedium.mediumLimitCache.maxCommunicationRange = 600m
*.radioMedium.mediumLimitCache.maxInterferenceRange = 1000m

# Background noise (realistic environment)
*.radioMedium.backgroundNoise.power = -90dBm

#===================================================================================
# ROUTING - Proactive Mesh Routing
#===================================================================================
# INET 4.x uses internal routing mechanisms
# For explicit OLSR: use OLSR module from INET extensions
#
# Ref: [5] RFC 3626: Optimized Link State Routing Protocol
# Ref: Rosati et al. (2016) "Dynamic routing for flying ad hoc networks"
#===================================================================================

*.drone[*].hasIpv4 = true
*.drone[*].ipv4.routingTable.netmaskRoutes = ""

# IPv4 parameters for multi-hop mesh networking
*.drone[*].ipv4.ip.timeToLive = 32                     # Allow multi-hop forwarding
*.drone[*].ipv4.ip.multicastTimeToLive = 32            # TTL for multicast packets
*.drone[*].ipv4.ip.forwarding = true                   # Enable packet forwarding (mesh relay)
*.drone[*].ipv4.ip.multicastForwarding = true          # Forward multicast packets
*.gcs[*].ipv4.ip.timeToLive = 32
*.gcs[*].ipv4.ip.multicastTimeToLive = 32
*.gcs[*].ipv4.ip.forwarding = true
*.gcs[*].ipv4.ip.multicastForwarding = true

# Network configurator (disable static routing)
*.configurator.addStaticRoutes = false
*.configurator.addDefaultRoutes = false
*.configurator.addSubnetRoutes = false

#===================================================================================
# APPLICATION LAYER - UDP Telemetry Exchange
#===================================================================================
# Periodic multicast for swarm coordination
#
# Telemetry packet structure (~48 bytes payload):
#   - Position (x,y,z): 12 bytes
#   - Velocity (vx,vy,vz): 12 bytes  
#   - Heading/attitude: 8 bytes
#   - Status/flags: 4 bytes
#   - Timestamp: 8 bytes
#   - Node ID: 4 bytes
#   + Headers (UDP 8B + IP 20B) = ~76 bytes total
#   → Rounded to 150B for extensibility
#
# Update rate: 10 Hz (100ms) - standard for UAV control loops
# Data rate per drone: 150B × 8 × 10Hz = 12 kbps
# Total load (10 drones): ~120 kbps (well below WiFi capacity)
#
# Ref: MAVLink protocol (mavlink.io)
# Ref: Meier et al. (2011) "MAVLink: Micro air vehicle communication protocol"
#===================================================================================

*.drone[*].numApps = 1
*.drone[*].app[0].typename = "UdpBasicApp"
*.drone[*].app[0].destAddresses = "224.0.0.1"          # Multicast to all
*.drone[*].app[0].destPort = 4000
*.drone[*].app[0].localPort = 4000
*.drone[*].app[0].messageLength = 150B
*.drone[*].app[0].sendInterval = 100ms                 # 10 Hz
*.drone[*].app[0].startTime = uniform(1s, 3s)          # Staggered start
*.drone[*].app[0].stopTime = 295s
*.drone[*].app[0].timeToLive = 32                      # TTL for multi-hop mesh

#===================================================================================
# GROUND CONTROL STATION (GCS)
#===================================================================================
# Stationary base station at center of operational area
#===================================================================================

*.gcs[*].mobility.typename = "StationaryMobility"
*.gcs[*].mobility.initFromDisplayString = false
*.gcs[*].mobility.initialX = 2500m                     # Center of 5km × 5km area
*.gcs[*].mobility.initialY = 2500m
*.gcs[*].mobility.initialZ = 2m

#-----------------------------------------------------------------------------------
# GCS Radio (higher power than drones)
#-----------------------------------------------------------------------------------
# Power: 20 mW (13 dBm) - 4× drone power for ~500-600m range
# Ref: Bujari et al. (2017) "Flying ad-hoc network application scenarios"
*.gcs[*].numWlanInterfaces = 1
*.gcs[*].wlan[0].typename = "Ieee80211Interface"
*.gcs[*].wlan[0].mgmt.typename = "Ieee80211MgmtAdhoc"
*.gcs[*].wlan[0].radio.typename = "Ieee80211ScalarRadio"
*.gcs[*].wlan[0].radio.bandName = "5 GHz"
*.gcs[*].wlan[0].radio.carrierFrequency = 5.8GHz
*.gcs[*].wlan[0].radio.bandwidth = 20MHz
*.gcs[*].wlan[0].radio.transmitter.power = 20mW
*.gcs[*].wlan[0].radio.receiver.sensitivity = -75dBm
*.gcs[*].wlan[0].radio.receiver.energyDetection = -78dBm
*.gcs[*].wlan[0].radio.receiver.snirThreshold = 6dB

# Network stack
*.gcs[*].hasIpv4 = true
*.gcs[*].hasUdp = true

# GCS Application - receives telemetry from all drones
*.gcs[*].numApps = 1
*.gcs[*].app[0].typename = "UdpSink"
*.gcs[*].app[0].localPort = 4000

#===================================================================================
# VISUALIZATION
#===================================================================================
*.visualizer.typename = "IntegratedCanvasVisualizer"
*.visualizer.mobilityVisualizer.displayMovements = true
*.visualizer.mobilityVisualizer.displayPositions = true
*.visualizer.mobilityVisualizer.trailLength = 100

# Communication range (GCS only, to avoid visual clutter)
*.visualizer.mediumVisualizer.displayCommunicationRanges = true
*.gcs[*].wlan[0].radio.displayCommunicationRange = true
*.drone[*].wlan[0].radio.displayCommunicationRange = false

#===================================================================================
# STATISTICS
#===================================================================================
**.scalar-recording = true
**.vector-recording = true

# Key metrics for swarm analysis
*.drone[*].app[0].packetSent:count.statistic = "sent"
*.drone[*].app[0].packetReceived:count.statistic = "received"
*.drone[*].wlan[0].radio.receptionState:vector.statistic = "radioState"

#===================================================================================
# SIMULATION CONFIGURATION
#===================================================================================

[Config DroneSwarm5km]
extends = General
description = "Drone swarm SAR mission - 10 drones, 5km × 5km area"

# Configuration details:
#   - Area: 5000m × 5000m (25 km²) - standard SAR coverage
#   - Speed: 15 m/s (54 km/h) - energy-efficient cruise
#   - Radio: ~500-600m range (multi-hop mesh network)
#   - Multi-hop required for full area coverage
#
# Execute: ./run.sh DroneSwarm5km
# Execute (console): ./run-cmdenv.sh DroneSwarm5km
#
# Based on:
#   [3] Hayat et al. (2016) "Survey on UAV networks for disaster relief"
#   [4] Erdelj et al. (2017) "Help from the sky: Leveraging UAVs for disaster management"
#===================================================================================